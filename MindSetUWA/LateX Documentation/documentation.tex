
\documentclass[a4paper,11pt]{book}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage{lmodern}

\usepackage{hyperref}
\usepackage{graphicx}
\usepackage[english]{babel}

\newenvironment{dedication}
{
   \cleardoublepage
   \thispagestyle{empty}
   \vspace*{\stretch{1}}
   \hfill\begin{minipage}[t]{0.66\textwidth}
   \raggedright
}
{
   \end{minipage}
   \vspace*{\stretch{3}}
   \clearpage
}

\makeatletter
\renewcommand{\@chapapp}{}% Not necessary...
\newenvironment{chapquote}[2][2em]
  {\setlength{\@tempdima}{#1}%
   \def\chapquote@author{#2}%
   \parshape 1 \@tempdima \dimexpr\textwidth-2\@tempdima\relax%
   \itshape}
  {\par\normalfont\hfill--\ \chapquote@author\hspace*{\@tempdima}\par\bigskip}
\makeatother


\title{\Huge \textbf{MindSetUWP}   \\ \hugeb MindWave EEG Headset library for Windows 10 universal applications}
\author{\textsc{Ondrej Rehacek}\thanks{\url{reh0063@vsb.cz}}}


\usepackage{listings}
\usepackage{color}

\definecolor{dkgreen}{rgb}{0,0.6,0}
\definecolor{gray}{rgb}{0.5,0.5,0.5}
\definecolor{mauve}{rgb}{0.58,0,0.82}

\lstset{frame=tb,
  language=[Sharp]C,
  aboveskip=3mm,
  belowskip=3mm,
  showstringspaces=false,
  columns=flexible,
  basicstyle={\small\ttfamily},
  numbers=none,
  numberstyle=\tiny\color{gray},
  keywordstyle=\color{blue},
  commentstyle=\color{dkgreen},
  stringstyle=\color{mauve},
  breaklines=true,
  breakatwhitespace=true,
  tabsize=3
}

\begin{document}

\maketitle
\tableofcontents
\mainmatter

\chapter*{General information}
A NeuroSky MindWave and MindWave Mobile EEG headset library for Windows 10 universal applications ecosystem. A part of my bachelor thesis at VÅ B - Technical University of Ostrava. Study year 2015-2016. Library is designed primary for use with MindWave Mobile bluetooth headset paired with Windows 10 device. You can easilly recieve EEG readings to any UWA application and use them.

\section*{Legacy mode}
However library also include a separate "legacy compatibic usor MindWave headsets that uses RF 2.4Ghz dongle. This legacy compatibility is limited to a devices that are capable to run ThinkGear connector software locally (So only Windows 10 for x86 desktop - this is due to a limitation to a ThinkGear software itself that only accepts packet connection from local device.) Legacy mode is not discussed only in separate part of the documentation, nor is endorsed to use on end-user appliaction and wich is only suitable for testing purpouses.

\section*{Basics}
Library can be used for any .NET Windows 10 Universal application running on every Windows 10 device that have a bluetooth adapter installed with appropriate system drivers. The EEG headset must be paired in the system Bluettooth menu prior to the use of the library itself.


\chapter{Basic Usage}

\section{Creating the instance of MindSetConnection}
After you sucsesfully imported the library into your application references, you can proceed by declaring the instance of MindSetConnection - a class that represents a connection to a EEG headset. 

\begin{lstlisting}
// Create a new instance of MindSetConnection class.
private MindSetConnection MyHeadset = new MindSetConnection();
\end{lstlisting}

\section{Establishing Bluetooth connection}
Now we can use a method "ConnectBluetooth" followed by suppling the bluetooth name of the  (In most cases the name is "MindWave Mobile") to initiate the packet connection to the EEG headset - that is all, easy as that - now we are recieving the formatted EEG readings from the headset. 

\begin{lstlisting}
private void EstConnBtn_Click(object sender, RoutedEventArgs e)
        {
            //Initiate bluetooth connection to a headset named "MindWave Mobile"
            MyHeadset.ConnectBluetooth("MindWave Mobile");
        }
\end{lstlisting}

\section{Working with EEG data}
MindSet headset transmits ThinkGear Data Values, encoded within TinkGear Packets, as a serial stream
of bytes over Bluetooth via a standard Bluetooth Serial Port Profile (SPP). MindSetUWP library process all of this packets and manages bluetooth connection with headset for you, so you are no longer required to do any extra work. Before we start working with the data , lets talk about all measurements that headset send to your applicaion and this library supports.


\begin{table}[ht]
\caption{EEG Data} % title of Table
\centering % used for centering table
\begin{tabular}{c c c c}
% centered columns (4 columns)
\hline\hline %inserts double horizontal lines
Variable Name & Value Range & Type & Required \\ [0.5ex]
% inserts table
%heading
\hline % inserts single horizontal line
Delta & 0.5 - 2.75Hz & Integer & X \\
Theta & 3.5 - 6.75Hz & Integer & X \\
AlphaLow & 7.5 - 9.25Hz & Integer & X \\
AlphaHigh & 10 - 11.75Hz & Integer & X \\
BetaLow & 13 - 16.75Hz & Integer & X \\
BetaHigh & 18 - 29.75Hz & Integer & X \\
GammaLow & 31 - 39.75Hz & Integer & X \\
GammaMid & 41 - 49.75Hz & Integer & X \\
esense.attention & 0 - 100 & Integer &  \\
esense.meditation & 0 - 100 & Integer &  \\ [1ex]
TimeStamp &  & DateTime & X \\
Quality & 0-255 & Integer & X \\ [1ex] % [1ex] adds vertical space
\hline %inserts single line
\end{tabular}
\label{table:nonlin} % is used to refer this table in the text
\end{table}

All of the variables in the table represent particular EEG data recieved from the MindWave headset, they are publicly acessible variables in the instance you created and connected to a headset using "RealtimeData" class. 

\begin{lstlisting}
    private void ShowDataBtn_Click(object sender, RoutedEventArgs e)
        { 
            Debug.Write(MyHeadset.RealtimeData.AlphaHigh); //Writes AlpaHigh data into debug console.
            Debug.Write(MyHeadset.RealtimeData.AlphaLow);  //Writes AlpaLow data into debug console.
        }
\end{lstlisting}


\noindent This is of course the most basic example of how you can work with the EEG data from the headset, you can use and work with them like with any public variable in your application. They are updated constantly while the bluetooth headset is connected.

\subsection{Alternative methods of working with EEG data.}
MindSetUWP library also contains alternative three methods how you can work with recieved EEG data. Theese three methods are called \textbf{AllToIntArray} witch returns an integer array with all of the EEG readings. Alternatively you can use \textbf{AllToArray} wich returns array of all EEG readings formatted to a string values.The position of EEG data in this arrays are the same as in the Table 1.1 in this document. At last you can also use \textbf{AllToString} that returns a long nicelly formated text string of all EEG values.

\begin{lstlisting}
     private void WrtDataBtn_Click(object sender, RoutedEventArgs e)
        { 
            Debug.Write(MyHeadset.RealtimeData.AllToString());  //Writes all of the data into debug console.

            int[] TableofEEG = MyHeadset.RealtimeData.AllToIntArray();  //Writes all of the data into integer array.
        }
\end{lstlisting}


\chapter{Advanced Usage}

\section{Handling Events}
TODO

\section{Legacy Connection - RF MindWave}
TODO

\section{RAW EEG Data}
TODO

\end{document}
